<!DOCTYPE html>
<html>
<head>
  <title>language.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "src/language.coffee";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0" /></head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io"
  onmouseover="logo.src='https://alinex.github.io/images/Alinex-200.png'"
  onmouseout="logo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="logo" src="https://alinex.github.io/images/Alinex-black-200.png"
    width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png"
    style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog"
    class="btn btn-primary"><span class="glyphicon-pencil"></span> Blog</a>
  <a href="http://alinex.github.io/develop"
    class="btn btn-primary"><span class="glyphicon-book"></span> Develop</a>
  <a href="http://alinex.github.io/code.html"
    class="btn btn-warning"><span class="glyphicon-cog"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#startup-script">Startup script</a>
      </div>

      <div class="heading h2">
        <a href="#node-modules">Node Modules</a>
      </div>

      <div class="heading h2">
        <a href="#detection">Detection</a>
      </div>

      <div class="heading h2">
        <a href="#language-definition">Language definition</a>
      </div>

      <div class="heading h1">
        <a href="#languages">Languages</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-codedoc" title="Fork me on GitHub"></a>
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="startup-script">
  <h1>
    <a href="#startup-script" name="startup-script" class="pilcrow"></a>
Startup script
  </h1>
</div>

        </td>
        <td class="code highlight">
          
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-modules">
  <h2>
    <a href="#node-modules" name="node-modules" class="pilcrow"></a>
Node Modules
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">path = <span class="hljs-built_in">require</span> <span class="hljs-string">'path'</span>


shebangRegex = <span class="hljs-regexp">///
  ^                     <span class="hljs-comment"># start of contents</span>
  \<span class="hljs-comment">#!                   # this have to be the first two bytes</span>
  \s*(?:/usr/bin/env)?  <span class="hljs-comment"># the call to search executable in path</span>
  \s*(?:[^\n]*/)*       <span class="hljs-comment"># any path before the executable</span>
  ([^/\n]+)             <span class="hljs-comment"># the executable</span>
  (?:\n|$)              <span class="hljs-comment"># end of line</span>
  ///</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="detection">
  <h2>
    <a href="#detection" name="detection" class="pilcrow"></a>
Detection
  </h2>
</div>
<p>Provides language-specific params for a given file name.</p>
<p>@param {string} filename The name of the file to test
@param {string} contents The contents of the file (to check for shebang)
@return {object} Object containing all of the language-specific params</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">(file, contents)</span> -&gt;</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>First try to detect the language from the file extension</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  ext = path.extname(file)[<span class="hljs-number">1.</span>.]
  <span class="hljs-keyword">return</span> languages.cpp <span class="hljs-keyword">if</span> ext <span class="hljs-keyword">is</span> <span class="hljs-string">'C'</span> <span class="hljs-comment"># hacky of incorporating .C for C++</span>
  ext = ext.toLowerCase()
  base = path.basename(file).toLowerCase()</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>search for match</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-keyword">for</span> _, l <span class="hljs-keyword">of</span> languages
    <span class="hljs-keyword">return</span> l <span class="hljs-keyword">if</span> l.extensions? <span class="hljs-keyword">and</span> ext <span class="hljs-keyword">in</span> l.extensions
    <span class="hljs-keyword">return</span> l <span class="hljs-keyword">if</span> l.names? <span class="hljs-keyword">and</span> base <span class="hljs-keyword">in</span> l.names</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>If that doesn't work, see if we can grab a shebang</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  match = shebangRegex.exec(contents)
  <span class="hljs-keyword">if</span> match
    <span class="hljs-keyword">for</span> _, l <span class="hljs-keyword">of</span> languages
      <span class="hljs-keyword">return</span> l <span class="hljs-keyword">if</span> l.executables? <span class="hljs-keyword">and</span> match[<span class="hljs-number">1</span>] <span class="hljs-keyword">in</span> l.executables</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>If we still can't figure it out, give up and return null.</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">  <span class="hljs-literal">null</span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="language-definition">
  <h2>
    <a href="#language-definition" name="language-definition" class="pilcrow"></a>
Language definition
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">
C_DOC =
  <span class="hljs-regexp">///
    \s*         <span class="hljs-comment"># with optional spaces</span>
    /\*{2,}     <span class="hljs-comment"># start with slash and at least two asterisk</span>
    (           <span class="hljs-comment"># content of the comment</span>
      [\s\S]*?  <span class="hljs-comment"># comment charactes</span>
    )           <span class="hljs-comment"># end of comment</span>
    \*+/        <span class="hljs-comment"># at least one asterisk and slash</span>
    \s*         <span class="hljs-comment"># with optional spaces</span>
  ///</span>g
HASH_DOC =
  <span class="hljs-regexp">///           <span class="hljs-comment"># ###\n ... \n###</span>
    (?:^|\n)    <span class="hljs-comment"># start of document or line</span>
    \s*         <span class="hljs-comment"># with optional spaces</span>
    \<span class="hljs-subst">#{<span class="hljs-number">3</span>}</span>       <span class="hljs-comment"># then three hashes: ###</span>
    (           <span class="hljs-comment"># content of the comment</span>
      [^\<span class="hljs-comment">#]     # no more than the three hashes</span>
      .*        <span class="hljs-comment"># everything in that line</span>
      \n\s*\<span class="hljs-comment">#   # each following line start with an hash</span>
      \s?.*     <span class="hljs-comment"># and all in that line</span>
    )           <span class="hljs-comment"># end of comment</span>
    \n          <span class="hljs-comment"># end the match</span>
  ///</span>g</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="languages">
  <h1>
    <a href="#languages" name="languages" class="pilcrow"></a>
Languages
  </h1>
</div>
<p>All the languages Docker can parse are in here.
A language can have the following properties:</p>
<ul>
<li><code>extensions</code>: All possible file extensions for the language</li>
<li><code>executables</code>: Executables for the language that might be in a shebang</li>
<li><code>comment</code>: Delimiter for single-line comments</li>
<li><code>multiLine</code>: Start and end delimiters for multi-line comments</li>
<li><code>commentsIgnore</code>: Regex for comments that shouldn't be interpreted as descriptive</li>
<li><code>jsDoc</code>: whether to try and extract jsDoc-style comment data</li>
<li><code>literals</code>: Quoted strings are ignored when looking for comment delimiters.
Any extra literals go here</li>
<li><code>highlightLanguage</code>: override for language to use with highlight.js</li>
</ul>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">languages =
  coffeescript:
    extensions: [ <span class="hljs-string">'coffee'</span> ]
    names: [ <span class="hljs-string">'cakefile'</span> ]
    executables: [ <span class="hljs-string">'coffee'</span> ]
    doc: [
      <span class="hljs-regexp">///           <span class="hljs-comment"># ###\n ... \n###</span>
        (?:^|\n)    <span class="hljs-comment"># start of document or line</span>
        \s*         <span class="hljs-comment"># with optional spaces</span>
        \<span class="hljs-subst">#{<span class="hljs-number">3</span>}</span>       <span class="hljs-comment"># then three hashes: ###</span>
        (           <span class="hljs-comment"># content of the comment</span>
          [^\<span class="hljs-comment">#]     # no more than the three hashes</span>
          [\s\S]*?  <span class="hljs-comment"># other comment charactes</span>
        )           <span class="hljs-comment"># end of comment</span>
        \<span class="hljs-subst">#{<span class="hljs-number">3</span>,}</span>      <span class="hljs-comment"># then three or more hashes</span>
        [ \t]*?\n   <span class="hljs-comment"># only spaces till end of line</span>
      ///</span>g
    ]
  javascript:
    extensions: [ <span class="hljs-string">'js'</span> ]
    executables: [ <span class="hljs-string">'node'</span> ]<span class="hljs-comment">#</span>
    doc: [ C_DOC ]
  livescript:
    extensions: [ <span class="hljs-string">'ls'</span> ]
    executables: [ <span class="hljs-string">'lsc'</span> ]
    doc: [ C_DOC ]
  ruby:
    extensions: [ <span class="hljs-string">'rb'</span>, <span class="hljs-string">'rbw'</span>, <span class="hljs-string">'rake'</span>, <span class="hljs-string">'gemspec'</span> ]
    executables: [ <span class="hljs-string">'ruby'</span> ]
    names: [ <span class="hljs-string">'rakefile'</span> ]
    doc: [
      <span class="hljs-regexp">///
        \s*\n       <span class="hljs-comment"># with optional spaces</span>
        =begin      <span class="hljs-comment"># start the line with '=begin'</span>
        \s*\n       <span class="hljs-comment"># and no more in this line</span>
        (           <span class="hljs-comment"># content of the comment</span>
          [\s\S]*?  <span class="hljs-comment"># comment charactes</span>
        )           <span class="hljs-comment"># end of comment</span>
        \s*\n       <span class="hljs-comment"># start a new line</span>
        =end        <span class="hljs-comment"># with '=end' at the start</span>
        \s*\n       <span class="hljs-comment"># with no more in this line</span>
      ///</span>g
    ]
  python:
    extensions: [ <span class="hljs-string">'py'</span> ]
    executables: [ <span class="hljs-string">'python'</span> ]
    doc: [ HASH_DOC ]
  perl:
    extensions: [ <span class="hljs-string">'pl'</span>, <span class="hljs-string">'pm'</span> ]
    executables: [ <span class="hljs-string">'perl'</span> ]
    doc: [
      <span class="hljs-regexp">///
        \s*\n       <span class="hljs-comment"># with optional spaces</span>
        =           <span class="hljs-comment"># start the line with any allowed pod command</span>
          (pod|head[1-4]|over|item|back|begin|end|for|encoding)
        \s*\n       <span class="hljs-comment"># and no more in this line</span>
        (           <span class="hljs-comment"># content of the comment</span>
          [\s\S]*?  <span class="hljs-comment"># comment charactes</span>
        )           <span class="hljs-comment"># end of comment</span>
        \s*\n       <span class="hljs-comment"># start a new line</span>
        =cut        <span class="hljs-comment"># with '=cut' at the start</span>
        \s*\n       <span class="hljs-comment"># with no more in this line</span>
      ///</span>g
    ]
  c:
    extensions: [ <span class="hljs-string">'c'</span>, <span class="hljs-string">'h'</span> ]
    executables: [ <span class="hljs-string">'gcc'</span> ]
    doc: [ C_DOC ]
  cpp:
    extensions: [ <span class="hljs-string">'cc'</span>, <span class="hljs-string">'cpp'</span> ]
    executables: [ <span class="hljs-string">'g++'</span> ]
    doc: [ C_DOC ]
  cs:
    extensions: [ <span class="hljs-string">'cs'</span> ]
    comment: <span class="hljs-string">'//'</span>
    doc: [ C_DOC ]
  java:
    extensions: [ <span class="hljs-string">'java'</span> ]
    doc: [ C_DOC ]
  jsp:
    extensions: [ <span class="hljs-string">'jsp'</span> ]
    doc: [ C_DOC ]
  php:
    extensions: [ <span class="hljs-string">'php'</span>, <span class="hljs-string">'phtml'</span>, <span class="hljs-string">'php3'</span>, <span class="hljs-string">'php4'</span>, <span class="hljs-string">'php5'</span>, <span class="hljs-string">'php7'</span> ]
    executables: [ <span class="hljs-string">'php'</span> ]
    doc: [ C_DOC ]
  bash:
    extensions: [ <span class="hljs-string">'sh'</span>, <span class="hljs-string">'kst'</span>, <span class="hljs-string">'bash'</span> ]
    names: [ <span class="hljs-string">'.bashrc'</span>, <span class="hljs-string">'bashrc'</span>]
    executables: [ <span class="hljs-string">'bash'</span>, <span class="hljs-string">'sh'</span>, <span class="hljs-string">'zsh'</span> ]
    doc: [ HASH_DOC ]
  yaml:
    extensions: [ <span class="hljs-string">'yaml'</span>, <span class="hljs-string">'yml'</span> ]
    doc: [ HASH_DOC ]
  markdown:
    extensions: [ <span class="hljs-string">'md'</span>, <span class="hljs-string">'mkd'</span>, <span class="hljs-string">'markdown'</span> ]
    type: <span class="hljs-string">'markdown'</span>
  scss:
    extensions: [ <span class="hljs-string">'scss'</span> ]
    comment: <span class="hljs-string">'//'</span>
    doc: [ C_DOC ]
  makefile:
    names: [ <span class="hljs-string">'makefile'</span> ]
    doc: [ HASH_DOC ]
  apache:
    names: [ <span class="hljs-string">'.htaccess'</span>, <span class="hljs-string">'apache.conf'</span>, <span class="hljs-string">'apache2.conf'</span> ]
    doc: [ HASH_DOC ]
  handlebars:
    extensions: [ <span class="hljs-string">'hbs'</span>, <span class="hljs-string">'handlebars'</span> ]
  groovy:
    extensions: [ <span class="hljs-string">'groovy'</span> ]
    doc: [ C_DOC ]
  stylus:
    extensions: [ <span class="hljs-string">'styl'</span> ]
    doc: [ C_DOC ]
  css:
    extensions: [ <span class="hljs-string">'css'</span> ]
    doc: [ C_DOC ]
  less:
    extensions: [ <span class="hljs-string">'less'</span> ]
    doc: [ C_DOC ]
  html:
    extensions: [ <span class="hljs-string">'html'</span>, <span class="hljs-string">'htm'</span> ]
  json:
    extensions: [ <span class="hljs-string">'json'</span> ]
    names: [ <span class="hljs-string">'.eslintrc'</span>, <span class="hljs-string">'.jshintrc'</span> ]</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>also add the language name within the definition</p>

        </td>
        <td class="code highlight">
          <pre class="coffeescript">l.name = name <span class="hljs-keyword">for</span> name, l <span class="hljs-keyword">of</span> languages</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
